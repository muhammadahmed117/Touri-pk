{% extends 'base.html' %}
{% load static %}

{% block title %}Check Weather - TouriPK{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Page Header -->
            <div class="text-center mb-5">
                <i class="fas fa-cloud-sun fa-4x text-primary mb-3"></i>
                <h1 class="display-5 fw-bold">Weather Check</h1>
                <p class="lead text-muted">Check current weather conditions for your destination</p>
            </div>

            <!-- Search Form -->
            <div class="card shadow-sm mb-4">
                <div class="card-body p-4">
                    <form method="GET" action="{% url 'content:check_weather' %}" id="weatherForm">
                        <div class="input-group input-group-lg">
                            <span class="input-group-text bg-primary text-white">
                                <i class="fas fa-search"></i>
                            </span>
                            <input 
                                type="text" 
                                name="city" 
                                class="form-control" 
                                placeholder="Enter city name (e.g., Islamabad, Karachi, Lahore)" 
                                value="{{ city|default:'' }}"
                                required
                                autofocus
                            >
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-search"></i> Check Weather
                            </button>
                        </div>
                        <small class="text-muted mt-2 d-block">
                            <i class="fas fa-info-circle"></i> Try: Islamabad, Karachi, Lahore, Gilgit, Murree, Naran
                        </small>
                    </form>
                </div>
            </div>

            <!-- Weather Display -->
            {% if city %}
                {% if weather_data %}
                <div class="card shadow-lg border-0 weather-card">
                    <div class="card-header bg-gradient text-white text-center py-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <h2 class="mb-0">
                            <i class="fas fa-map-marker-alt"></i> {{ city|title }}
                        </h2>
                        <small class="opacity-75">{{ weather_data.last_updated }}</small>
                    </div>
                    <div class="card-body p-5">
                        <div class="row align-items-center">
                            <!-- Temperature -->
                            <div class="col-md-6 text-center mb-4 mb-md-0">
                                <div class="weather-icon-large mb-3">
                                    <img 
                                        src="https:{{ weather_data.icon }}" 
                                        alt="{{ weather_data.description }}"
                                        style="width: 150px; height: 150px;"
                                    >
                                </div>
                                <h1 class="display-1 fw-bold text-primary mb-0">
                                    {{ weather_data.temperature }}°C
                                </h1>
                                <p class="lead text-muted mb-0">{{ weather_data.description }}</p>
                            </div>

                            <!-- Weather Details -->
                            <div class="col-md-6">
                                <div class="weather-details">
                                    <div class="detail-item p-3 mb-3 bg-light rounded">
                                        <div class="d-flex align-items-center">
                                            <div class="icon-box bg-primary text-white rounded-circle p-3 me-3">
                                                <i class="fas fa-thermometer-half fa-2x"></i>
                                            </div>
                                            <div>
                                                <small class="text-muted d-block">Feels Like</small>
                                                <h4 class="mb-0">{{ weather_data.feels_like }}°C</h4>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="detail-item p-3 mb-3 bg-light rounded">
                                        <div class="d-flex align-items-center">
                                            <div class="icon-box bg-info text-white rounded-circle p-3 me-3">
                                                <i class="fas fa-tint fa-2x"></i>
                                            </div>
                                            <div>
                                                <small class="text-muted d-block">Humidity</small>
                                                <h4 class="mb-0">{{ weather_data.humidity }}%</h4>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="detail-item p-3 bg-light rounded">
                                        <div class="d-flex align-items-center">
                                            <div class="icon-box bg-success text-white rounded-circle p-3 me-3">
                                                <i class="fas fa-wind fa-2x"></i>
                                            </div>
                                            <div>
                                                <small class="text-muted d-block">Wind Speed</small>
                                                <h4 class="mb-0">{{ weather_data.wind_speed }} m/s</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Travel Tips -->
                        <div class="mt-4 p-4 bg-light rounded">
                            <h5 class="mb-3"><i class="fas fa-lightbulb text-warning"></i> Travel Tips</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    {% if weather_data.temperature > 30 %}
                                    <div class="alert alert-warning mb-2">
                                        <i class="fas fa-sun"></i> Very hot! Carry water and sunscreen.
                                    </div>
                                    {% elif weather_data.temperature > 20 %}
                                    <div class="alert alert-success mb-2">
                                        <i class="fas fa-smile"></i> Perfect weather for outdoor activities!
                                    </div>
                                    {% elif weather_data.temperature > 10 %}
                                    <div class="alert alert-info mb-2">
                                        <i class="fas fa-cloud"></i> Pleasant weather. Light jacket recommended.
                                    </div>
                                    {% else %}
                                    <div class="alert alert-primary mb-2">
                                        <i class="fas fa-snowflake"></i> Cold weather. Warm clothes required.
                                    </div>
                                    {% endif %}
                                </div>
                                <div class="col-md-6">
                                    {% if weather_data.humidity > 70 %}
                                    <div class="alert alert-info mb-2">
                                        <i class="fas fa-droplet"></i> High humidity. Stay hydrated!
                                    </div>
                                    {% endif %}
                                    {% if weather_data.wind_speed > 10 %}
                                    <div class="alert alert-warning mb-2">
                                        <i class="fas fa-wind"></i> Windy conditions. Secure loose items.
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Popular Destinations -->
                <div class="mt-4 text-center">
                    <h5 class="mb-3">Quick Check Popular Destinations</h5>
                    <div class="btn-group flex-wrap" role="group">
                        <a href="?city=Islamabad" class="btn btn-outline-primary">Islamabad</a>
                        <a href="?city=Karachi" class="btn btn-outline-primary">Karachi</a>
                        <a href="?city=Lahore" class="btn btn-outline-primary">Lahore</a>
                        <a href="?city=Gilgit" class="btn btn-outline-primary">Gilgit</a>
                        <a href="?city=Murree" class="btn btn-outline-primary">Murree</a>
                        <a href="?city=Naran" class="btn btn-outline-primary">Naran</a>
                    </div>
                </div>

                {% else %}
                <!-- Error Message -->
                <div class="card shadow-sm border-danger">
                    <div class="card-body text-center py-5">
                        <i class="fas fa-exclamation-triangle fa-4x text-danger mb-3"></i>
                        <h3 class="text-danger">Unable to Fetch Weather Data</h3>
                        <p class="text-muted">
                            Could not retrieve weather information for "{{ city }}". 
                            Please check the city name and try again.
                        </p>
                        <div class="alert alert-info mt-3">
                            <strong><i class="fas fa-info-circle"></i> Possible Reasons:</strong>
                            <ul class="mb-0 mt-2 text-start">
                                <li>City name might be misspelled</li>
                                <li>Weather API service temporarily unavailable</li>
                                <li>City not found in weather database</li>
                            </ul>
                        </div>
                        <div class="mt-4">
                            <h5>Try these popular cities:</h5>
                            <div class="btn-group flex-wrap mt-2" role="group">
                                <a href="?city=Islamabad" class="btn btn-primary">Islamabad</a>
                                <a href="?city=Karachi" class="btn btn-primary">Karachi</a>
                                <a href="?city=Lahore" class="btn btn-primary">Lahore</a>
                                <a href="?city=Gilgit" class="btn btn-primary">Gilgit</a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
            {% else %}
                <!-- Welcome Message -->
                <div class="card shadow-sm border-0">
                    <div class="card-body text-center py-5">
                        <i class="fas fa-cloud-sun-rain fa-5x text-primary mb-4"></i>
                        <h3 class="mb-3">Welcome to Weather Check</h3>
                        <p class="text-muted lead">
                            Plan your trip better by checking real-time weather conditions for any destination in Pakistan.
                        </p>
                        
                        <div class="mt-5">
                            <h5 class="mb-3">Popular Destinations</h5>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <a href="?city=Islamabad" class="btn btn-outline-primary w-100">
                                        <i class="fas fa-city"></i> Islamabad
                                    </a>
                                </div>
                                <div class="col-md-4">
                                    <a href="?city=Karachi" class="btn btn-outline-primary w-100">
                                        <i class="fas fa-building"></i> Karachi
                                    </a>
                                </div>
                                <div class="col-md-4">
                                    <a href="?city=Lahore" class="btn btn-outline-primary w-100">
                                        <i class="fas fa-mosque"></i> Lahore
                                    </a>
                                </div>
                                <div class="col-md-4">
                                    <a href="?city=Gilgit" class="btn btn-outline-success w-100">
                                        <i class="fas fa-mountain"></i> Gilgit
                                    </a>
                                </div>
                                <div class="col-md-4">
                                    <a href="?city=Murree" class="btn btn-outline-success w-100">
                                        <i class="fas fa-tree"></i> Murree
                                    </a>
                                </div>
                                <div class="col-md-4">
                                    <a href="?city=Naran" class="btn btn-outline-success w-100">
                                        <i class="fas fa-snowflake"></i> Naran
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-info mt-5 text-start">
                            <h6><i class="fas fa-info-circle"></i> About This Service</h6>
                            <ul class="mb-0">
                                <li>Real-time weather data from OpenWeatherMap</li>
                                <li>Temperature in Celsius</li>
                                <li>Wind speed in meters per second</li>
                                <li>Data updated every 30 minutes</li>
                            </ul>
                        </div>
                    </div>
                </div>
            {% endif %}

            <!-- Back to Home -->
            <div class="text-center mt-4">
                <a href="{% url 'home' %}" class="btn btn-outline-secondary">
                    <i class="fas fa-home"></i> Back to Home
                </a>
            </div>
        </div>
    </div>
</div>

<style>
.weather-card {
    animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.icon-box {
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.detail-item {
    transition: all 0.3s ease;
}

.detail-item:hover {
    transform: translateX(5px);
    box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
}

.bg-gradient {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.btn-group .btn {
    margin: 2px;
}
</style>

{% endblock %}
